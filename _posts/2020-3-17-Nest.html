<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Nest</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body>
	<img src="{{site.baseurl}}/assets/images/nest/nest.png">
	nmap shows 2 open ports:<br /><img src="{{site.baseurl}}/assets/images/nest/1-1.png" alt="{{site.baseurl}}/assets/images/nest/1-1.png" /><br /><br />smb allows null session, but with limited access. We find a password for a temporary user:<br /><img src="{{site.baseurl}}/assets/images/nest/1-2.png" alt="{{site.baseurl}}/assets/images/nest/1-2.png" /><br /><br />This TempUser unlocks some more files and some poking around gives us a nice little hash:<br /><img src="{{site.baseurl}}/assets/images/nest/1-3.png" alt="{{site.baseurl}}/assets/images/nest/1-3.png" /> <br /><br />i did try to use the hash as it is to see if that works as a password (suspecting its not a hash but is just plaintext) but that didnt work. So maybe some decryption is required<br /><br />The share "Secure$" has a listable folder IT/Carl, in which there is a code written in VBScript<br /><img src="{{site.baseurl}}/assets/images/nest/1-4.png" alt="{{site.baseurl}}/assets/images/nest/1-4.png" /> <br /><br />so we download the dir for further analysis:<br /><img src="{{site.baseurl}}/assets/images/nest/1-5.png" alt="{{site.baseurl}}/assets/images/nest/1-5.png" /><br /><br />so it looks like Module1.vb is using Utils.vb to decrypt the hash we found earlier:<br /><br />Module1.vb:<br /><div class="codebox"><div class="codebox"><span style="color:#ff9d00;font-weight:700">Module</span>&nbsp;Module1<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Sub</span>&nbsp;Main()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;Config&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;ConfigFile&nbsp;=&nbsp;ConfigFile.LoadFromFile(<span style="color:#3ad900;font-weight:400">"RU_Config.xml"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;test&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#ff9d00;font-weight:700">New</span>&nbsp;SsoIntegration&nbsp;<span style="color:#ff9d00;font-weight:700">With</span>&nbsp;{.Username&nbsp;=&nbsp;Config.Username,&nbsp;.Password&nbsp;=&nbsp;Utils.DecryptString(Config.Password)}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">End</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Sub</span><br /><br /><span style="color:#ff9d00;font-weight:700">End</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Module</span><br /></div></div><br /><br />Utils.vb:<br /><div class="codebox"><div class="codebox"><span style="color:#ff9d00;font-weight:700">Imports</span>&nbsp;System.<span style="color:#ff9d00;font-weight:700">Text</span><br /><span style="color:#ff9d00;font-weight:700">Imports</span>&nbsp;System.Security.Cryptography<br /><span style="color:#ff9d00;font-weight:700">Public</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Class</span>&nbsp;Utils<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Public</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Shared</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Function</span>&nbsp;GetLogFilePath()&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Return</span>&nbsp;IO.Path.Combine(Environment.CurrentDirectory,&nbsp;<span style="color:#3ad900;font-weight:400">"Log.txt"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">End</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Function</span><br /><br /><br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Public</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Shared</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Function</span>&nbsp;DecryptString(EncryptedString&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span><br /><span style="color:#333333;font-weight:400">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;String.IsNullOrEmpty(EncryptedString)&nbsp;Then</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Return</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span>.Empty<br /><span style="color:#333333;font-weight:400">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Return</span>&nbsp;Decrypt(EncryptedString,&nbsp;<span style="color:#3ad900;font-weight:400">"N3st22"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"88552299"</span>,&nbsp;2,&nbsp;<span style="color:#3ad900;font-weight:400">"464R5DFA5DL6LE28"</span>,&nbsp;256)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">End</span>&nbsp;<span style="color:#ff9d00;font-weight:700">If</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">End</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Function</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Public</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Shared</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Function</span>&nbsp;EncryptString(PlainString&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span><br /><span style="color:#333333;font-weight:400">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;String.IsNullOrEmpty(PlainString)&nbsp;Then</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Return</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span>.Empty<br /><span style="color:#333333;font-weight:400">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Return</span>&nbsp;Encrypt(PlainString,&nbsp;<span style="color:#3ad900;font-weight:400">"N3st22"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"88552299"</span>,&nbsp;2,&nbsp;<span style="color:#3ad900;font-weight:400">"464R5DFA5DL6LE28"</span>,&nbsp;256)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">End</span>&nbsp;<span style="color:#ff9d00;font-weight:700">If</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">End</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Function</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Public</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Shared</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Function</span>&nbsp;Encrypt(<span style="color:#ff9d00;font-weight:700">ByVal</span>&nbsp;plainText&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span>,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">ByVal</span>&nbsp;passPhrase&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span>,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">ByVal</span>&nbsp;saltValue&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span>,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">ByVal</span>&nbsp;passwordIterations&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Integer</span>,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">ByVal</span>&nbsp;initVector&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span>,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">ByVal</span>&nbsp;keySize&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Integer</span>)&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;initVectorBytes&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">Byte</span>()&nbsp;=&nbsp;Encoding.ASCII.GetBytes(initVector)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;saltValueBytes&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">Byte</span>()&nbsp;=&nbsp;Encoding.ASCII.GetBytes(saltValue)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;plainTextBytes&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">Byte</span>()&nbsp;=&nbsp;Encoding.ASCII.GetBytes(plainText)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;password&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#ff9d00;font-weight:700">New</span>&nbsp;Rfc2898DeriveBytes(passPhrase,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saltValueBytes,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;passwordIterations)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;keyBytes&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">Byte</span>()&nbsp;=&nbsp;password.GetBytes(<span style="color:#ff9d00;font-weight:700">CInt</span>(keySize&nbsp;/&nbsp;8))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;symmetricKey&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#ff9d00;font-weight:700">New</span>&nbsp;AesCryptoServiceProvider<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;symmetricKey.Mode&nbsp;=&nbsp;CipherMode.CBC<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;encryptor&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;ICryptoTransform&nbsp;=&nbsp;symmetricKey.CreateEncryptor(keyBytes,&nbsp;initVectorBytes)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using&nbsp;memoryStream&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#ff9d00;font-weight:700">New</span>&nbsp;IO.MemoryStream()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using&nbsp;cryptoStream&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#ff9d00;font-weight:700">New</span>&nbsp;CryptoStream(memoryStream,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encryptor,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CryptoStreamMode.Write)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cryptoStream.Write(plainTextBytes,&nbsp;0,&nbsp;plainTextBytes.Length)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cryptoStream.FlushFinalBlock()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;cipherTextBytes&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">Byte</span>()&nbsp;=&nbsp;memoryStream.ToArray()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memoryStream.Close()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cryptoStream.Close()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Return</span>&nbsp;Convert.ToBase64String(cipherTextBytes)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">End</span>&nbsp;Using<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">End</span>&nbsp;Using<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">End</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Function</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Public</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Shared</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Function</span>&nbsp;Decrypt(<span style="color:#ff9d00;font-weight:700">ByVal</span>&nbsp;cipherText&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span>,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">ByVal</span>&nbsp;passPhrase&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span>,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">ByVal</span>&nbsp;saltValue&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span>,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">ByVal</span>&nbsp;passwordIterations&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Integer</span>,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">ByVal</span>&nbsp;initVector&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span>,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">ByVal</span>&nbsp;keySize&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Integer</span>)&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;initVectorBytes&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">Byte</span>()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initVectorBytes&nbsp;=&nbsp;Encoding.ASCII.GetBytes(initVector)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;saltValueBytes&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">Byte</span>()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saltValueBytes&nbsp;=&nbsp;Encoding.ASCII.GetBytes(saltValue)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;cipherTextBytes&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">Byte</span>()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cipherTextBytes&nbsp;=&nbsp;Convert.FromBase64String(cipherText)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;password&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#ff9d00;font-weight:700">New</span>&nbsp;Rfc2898DeriveBytes(passPhrase,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saltValueBytes,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;passwordIterations)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;keyBytes&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">Byte</span>()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keyBytes&nbsp;=&nbsp;password.GetBytes(<span style="color:#ff9d00;font-weight:700">CInt</span>(keySize&nbsp;/&nbsp;8))<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;symmetricKey&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#ff9d00;font-weight:700">New</span>&nbsp;AesCryptoServiceProvider<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;symmetricKey.Mode&nbsp;=&nbsp;CipherMode.CBC<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;decryptor&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;ICryptoTransform<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decryptor&nbsp;=&nbsp;symmetricKey.CreateDecryptor(keyBytes,&nbsp;initVectorBytes)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;memoryStream&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;IO.MemoryStream<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memoryStream&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">New</span>&nbsp;IO.MemoryStream(cipherTextBytes)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;cryptoStream&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;CryptoStream<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cryptoStream&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">New</span>&nbsp;CryptoStream(memoryStream,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decryptor,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CryptoStreamMode.Read)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;plainTextBytes&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">Byte</span>()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">ReDim</span>&nbsp;plainTextBytes(cipherTextBytes.Length)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;decryptedByteCount&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Integer</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decryptedByteCount&nbsp;=&nbsp;cryptoStream.Read(plainTextBytes,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plainTextBytes.Length)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memoryStream.Close()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cryptoStream.Close()<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;plainText&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plainText&nbsp;=&nbsp;Encoding.ASCII.GetString(plainTextBytes,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decryptedByteCount)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Return</span>&nbsp;plainText<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">End</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Function</span><br /><br /><br /><br /><br /><br /><br /><span style="color:#ff9d00;font-weight:700">End</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Class</span><br /></div></div><br /><br />so modify things, cut-paste some code and we get this:<br /><div class="codebox"><div class="codebox"><span style="color:#ff9d00;font-weight:700">Imports</span>&nbsp;System<br /><span style="color:#ff9d00;font-weight:700">Imports</span>&nbsp;System.<span style="color:#ff9d00;font-weight:700">Text</span><br /><span style="color:#ff9d00;font-weight:700">Imports</span>&nbsp;System.Security.Cryptography<br />				<br /><span style="color:#ff9d00;font-weight:700">Public</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Module</span>&nbsp;Module1<br />	<br />	<span style="color:#ff9d00;font-weight:700">Public</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Sub</span>&nbsp;Main()<br />		<br />		Console.WriteLine(DecryptString(<span style="color:#3ad900;font-weight:400">"fTEzAfYDoz1YzkqhQkH6GQFYKp1XY5hm7bjOP86yYxE="</span>))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.ReadLine()<br />	<span style="color:#ff9d00;font-weight:700">End</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Sub</span><br />	<span style="color:#ff9d00;font-weight:700">Public</span>&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Function</span>&nbsp;DecryptString(EncryptedString&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span>)&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span><br /><span style="color:#333333;font-weight:400">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;String.IsNullOrEmpty(EncryptedString)&nbsp;Then</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Return</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span>.Empty<br /><span style="color:#333333;font-weight:400">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Return</span>&nbsp;Decrypt(EncryptedString,&nbsp;<span style="color:#3ad900;font-weight:400">"N3st22"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">"88552299"</span>,&nbsp;2,&nbsp;<span style="color:#3ad900;font-weight:400">"464R5DFA5DL6LE28"</span>,&nbsp;256)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">End</span>&nbsp;<span style="color:#ff9d00;font-weight:700">If</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">End</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Function</span><br />	<span style="color:#ff9d00;font-weight:700">Public</span>&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Function</span>&nbsp;Decrypt(<span style="color:#ff9d00;font-weight:700">ByVal</span>&nbsp;cipherText&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span>,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">ByVal</span>&nbsp;passPhrase&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span>,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">ByVal</span>&nbsp;saltValue&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span>,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">ByVal</span>&nbsp;passwordIterations&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Integer</span>,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">ByVal</span>&nbsp;initVector&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span>,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">ByVal</span>&nbsp;keySize&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Integer</span>)&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;initVectorBytes&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">Byte</span>()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initVectorBytes&nbsp;=&nbsp;Encoding.ASCII.GetBytes(initVector)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;saltValueBytes&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">Byte</span>()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saltValueBytes&nbsp;=&nbsp;Encoding.ASCII.GetBytes(saltValue)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;cipherTextBytes&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">Byte</span>()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cipherTextBytes&nbsp;=&nbsp;Convert.FromBase64String(cipherText)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;password&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#ff9d00;font-weight:700">New</span>&nbsp;Rfc2898DeriveBytes(passPhrase,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saltValueBytes,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;passwordIterations)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;keyBytes&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">Byte</span>()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keyBytes&nbsp;=&nbsp;password.GetBytes(<span style="color:#ff9d00;font-weight:700">CInt</span>(keySize&nbsp;/&nbsp;8))<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;symmetricKey&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#ff9d00;font-weight:700">New</span>&nbsp;AesCryptoServiceProvider<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;symmetricKey.Mode&nbsp;=&nbsp;CipherMode.CBC<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;decryptor&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;ICryptoTransform<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decryptor&nbsp;=&nbsp;symmetricKey.CreateDecryptor(keyBytes,&nbsp;initVectorBytes)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;memoryStream&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;IO.MemoryStream<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memoryStream&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">New</span>&nbsp;IO.MemoryStream(cipherTextBytes)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;cryptoStream&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;CryptoStream<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cryptoStream&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">New</span>&nbsp;CryptoStream(memoryStream,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decryptor,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CryptoStreamMode.Read)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;plainTextBytes&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">Byte</span>()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">ReDim</span>&nbsp;plainTextBytes(cipherTextBytes.Length)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;decryptedByteCount&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Integer</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decryptedByteCount&nbsp;=&nbsp;cryptoStream.Read(plainTextBytes,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plainTextBytes.Length)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memoryStream.Close()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cryptoStream.Close()<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Dim</span>&nbsp;plainText&nbsp;<span style="color:#ff9d00;font-weight:700">As</span>&nbsp;<span style="color:#7f0044;font-weight:400">String</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plainText&nbsp;=&nbsp;Encoding.ASCII.GetString(plainTextBytes,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;_<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decryptedByteCount)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">Return</span>&nbsp;plainText<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">End</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Function</span><br />	<br /><span style="color:#ff9d00;font-weight:700">End</span>&nbsp;<span style="color:#ff9d00;font-weight:700">Module</span><br /></div></div><br /><br />we can run this on some online VB compiler, like <a href="https://dotnetfiddle.net/">dotnetfiddle</a><br /><img src="{{site.baseurl}}/assets/images/nest/1-6.png" alt="{{site.baseurl}}/assets/images/nest/1-6.png" /><br />so now we have the plaintext password<br />we find user.txt on the smb share:<br /><img src="{{site.baseurl}}/assets/images/nest/1-7.png" alt="{{site.baseurl}}/assets/images/nest/1-7.png" /><br /><br />There is a file containing the password to the service running on port 4386, however it says it is 0 bytes in size<br />allinfo reveals that the file actually has two different streams on the ntfs filesystem<br /><br /><img src="{{site.baseurl}}/assets/images/nest/1-8.png" alt="{{site.baseurl}}/assets/images/nest/1-8.png" /><br /><br />So we download it with the password stream<br /><img src="{{site.baseurl}}/assets/images/nest/1-9.png" alt="{{site.baseurl}}/assets/images/nest/1-9.png" /> <br />now that we have the password to authenticate at the higher port, we can enumerate it<br /><br /><div class="codebox"><div class="codebox">&gt;setdir&nbsp;..<br /><br />Current&nbsp;directory&nbsp;set&nbsp;to&nbsp;HQK<br />&gt;list<br /><br />Use&nbsp;the&nbsp;query&nbsp;ID&nbsp;numbers&nbsp;below&nbsp;with&nbsp;the&nbsp;RUNQUERY&nbsp;command&nbsp;and&nbsp;the&nbsp;directory&nbsp;names&nbsp;with&nbsp;the&nbsp;SETDIR&nbsp;command<br /><br />&nbsp;QUERY&nbsp;FILES&nbsp;IN&nbsp;CURRENT&nbsp;DIRECTORY<br /><br />[DIR]&nbsp;&nbsp;ALL&nbsp;QUERIES<br />[DIR]&nbsp;&nbsp;LDAP<br />[DIR]&nbsp;&nbsp;Logs<br />[1]&nbsp;&nbsp;&nbsp;HqkSvc.exe<br />[2]&nbsp;&nbsp;&nbsp;HqkSvc.InstallState<br />[3]&nbsp;&nbsp;&nbsp;HQK_Config.xml<br /><br />Current&nbsp;Directory:&nbsp;HQK<br />&gt;setdir&nbsp;LDAP<br /><br />Current&nbsp;directory&nbsp;set&nbsp;to&nbsp;LDAP<br />&gt;list<br /><br />Use&nbsp;the&nbsp;query&nbsp;ID&nbsp;numbers&nbsp;below&nbsp;with&nbsp;the&nbsp;RUNQUERY&nbsp;command&nbsp;and&nbsp;the&nbsp;directory&nbsp;names&nbsp;with&nbsp;the&nbsp;SETDIR&nbsp;command<br /><br />&nbsp;QUERY&nbsp;FILES&nbsp;IN&nbsp;CURRENT&nbsp;DIRECTORY<br /><br />[1]&nbsp;&nbsp;&nbsp;HqkLdap.exe<br />[2]&nbsp;&nbsp;&nbsp;Ldap.conf<br /><br />Current&nbsp;Directory:&nbsp;LDAP<br />&gt;showquery&nbsp;2<br /><br />Domain=nest.local<br />Port=389<br />BaseOu=OU=WBQ&nbsp;Users,OU=Production,DC=nest,DC=local<br />User=Administrator<br />Password=yyEq0Uvvhq2uQOcWG8peLoeRQehqip/fKdeG/kjEVb4=</div></div><br /><br />the admins password hash! we struck the motherlode!<br /><br />There was this executable named HqKldap.exe that we found earlier, i decompiled it with dnSpy and made a few changes to the main module. more specifically, got rid of the optional file presence check, and printed the decrypted password to the console. Heres the final edited file:<br /><br /><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">//&nbsp;HqkLdap.MainModule</span><br /><span style="color:#0088ff;font-weight:400">//&nbsp;Token:&nbsp;0x06000027&nbsp;RID:&nbsp;39</span><br />[STAThread]<br /><span style="color:#ff9d00;font-weight:700">public</span>&nbsp;<span style="color:#ff9d00;font-weight:700">static</span>&nbsp;<span style="color:#ff9d00;font-weight:700">void</span>&nbsp;Main()<br />{<br />	<span style="color:#ff9d00;font-weight:700">checked</span><br />	{<br />		<span style="color:#ff9d00;font-weight:700">try</span><br />		{<br />			<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(MyProject.Application.CommandLineArgs.Count&nbsp;!=&nbsp;<span style="color:#ff0044;font-weight:400">1</span>)<br />			{<br />				Console.WriteLine(<span style="color:#3ad900;font-weight:400">"Invalid&nbsp;number&nbsp;of&nbsp;command&nbsp;line&nbsp;arguments"</span>);<br />			}<br />			<span style="color:#ff9d00;font-weight:700">else</span>&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(!File.Exists(MyProject.Application.CommandLineArgs[<span style="color:#ff0044;font-weight:400">0</span>]))<br />			{<br />				Console.WriteLine(<span style="color:#3ad900;font-weight:400">"Specified&nbsp;config&nbsp;file&nbsp;does&nbsp;not&nbsp;exist"</span>);<br />			}<br />			<span style="color:#ff9d00;font-weight:700">else</span><br />			{<br />				LdapSearchSettings&nbsp;ldapSearchSettings&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">new</span>&nbsp;LdapSearchSettings();<br />				<span style="color:#ff9d00;font-weight:700">foreach</span>&nbsp;(<span style="color:#7f0044;font-weight:400">string</span>&nbsp;text&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;File.ReadAllLines(MyProject.Application.CommandLineArgs[<span style="color:#ff0044;font-weight:400">0</span>]))<br />				{<br />					<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(text.StartsWith(<span style="color:#3ad900;font-weight:400">"Domain="</span>,&nbsp;StringComparison.CurrentCultureIgnoreCase))<br />					{<br />						ldapSearchSettings.Domain&nbsp;=&nbsp;text.Substring(text.IndexOf(<span style="color:#00117f;font-weight:400">'='</span>)&nbsp;+&nbsp;<span style="color:#ff0044;font-weight:400">1</span>);<br />					}<br />					<span style="color:#ff9d00;font-weight:700">else</span>&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(text.StartsWith(<span style="color:#3ad900;font-weight:400">"User="</span>,&nbsp;StringComparison.CurrentCultureIgnoreCase))<br />					{<br />						ldapSearchSettings.Username&nbsp;=&nbsp;text.Substring(text.IndexOf(<span style="color:#00117f;font-weight:400">'='</span>)&nbsp;+&nbsp;<span style="color:#ff0044;font-weight:400">1</span>);<br />					}<br />					<span style="color:#ff9d00;font-weight:700">else</span>&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;(text.StartsWith(<span style="color:#3ad900;font-weight:400">"Password="</span>,&nbsp;StringComparison.CurrentCultureIgnoreCase))<br />					{<br />						ldapSearchSettings.Password&nbsp;=&nbsp;CR.DS(text.Substring(text.IndexOf(<span style="color:#00117f;font-weight:400">'='</span>)&nbsp;+&nbsp;<span style="color:#ff0044;font-weight:400">1</span>));<br />					}<br />				}<br />				Ldap&nbsp;ldap&nbsp;=&nbsp;<span style="color:#ff9d00;font-weight:700">new</span>&nbsp;Ldap();<br />				ldap.Username&nbsp;=&nbsp;ldapSearchSettings.Username;<br />				ldap.Password&nbsp;=&nbsp;ldapSearchSettings.Password;<br />				ldap.Domain&nbsp;=&nbsp;ldapSearchSettings.Domain;<br />				Console.WriteLine(ldap.Password.ToString());<br />				Console.WriteLine(<span style="color:#3ad900;font-weight:400">"Performing&nbsp;LDAP&nbsp;query..."</span>);<br />				List&lt;<span style="color:#7f0044;font-weight:400">string</span>&gt;&nbsp;list&nbsp;=&nbsp;ldap.FindUsers();<br />				Console.WriteLine(Conversions.ToString(list.Count)&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;user&nbsp;accounts&nbsp;found.&nbsp;Importing&nbsp;to&nbsp;database..."</span>);<br />				<span style="color:#ff9d00;font-weight:700">foreach</span>&nbsp;(<span style="color:#7f0044;font-weight:400">string</span>&nbsp;text2&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;list)<br />				{<br />					Console.WriteLine(text2);<br />					Process.Start(<span style="color:#3ad900;font-weight:400">"HqkDbImport.exe&nbsp;/ImportLdapUser&nbsp;"</span>&nbsp;+&nbsp;text2);<br />				}<br />			}<br />		}<br />		<span style="color:#ff9d00;font-weight:700">catch</span>&nbsp;(Exception&nbsp;e)<br />		{<br />			Console.WriteLine(<span style="color:#3ad900;font-weight:400">"Unexpected&nbsp;error:&nbsp;"</span>&nbsp;+&nbsp;e.Message);<br />			Process.Start(<span style="color:#3ad900;font-weight:400">"Pause"</span>);<br />		}<br />	}<br />}<br /></div></div><br /><br />it needs a file as an argument so i created ldap.conf file:<br /><div class="codebox"><div class="codebox">Domain=nest.local<br />Port=389<br />BaseOu=OU=WBQ&nbsp;Users,OU=Production,DC=nest,DC=local<br />User=Administrator<br />Password=yyEq0Uvvhq2uQOcWG8peLoeRQehqip/fKdeG/kjEVb4=</div></div><br /><br />and passed that as an argument to the modified binary to get the admins password (program crashes since i dont have the htb vpn configured on my windows machine so no way to connect to the box):<br /><br /><img src="{{site.baseurl}}/assets/images/nest/1-10.png" alt="{{site.baseurl}}/assets/images/nest/1-10.png" /><br /><br />Now we can mount C$ and get root.txt<br /><img src="{{site.baseurl}}/assets/images/nest/1-11.png" alt="{{site.baseurl}}/assets/images/nest/1-11.png" /><br /></body></html>