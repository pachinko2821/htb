<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>traceback</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><h1><b><u>traceback</u></b></h1>site seems to have been defaced, and there is a backdoor left behind<br /><img src="{{site.baseurl}}/assets/images/traceback/1-1.png" alt="{{site.baseurl}}/assets/images/traceback/1-1.png" /><br /><br />reading the source, we find a comment<br /><img src="{{site.baseurl}}/assets/images/traceback/1-2.png" alt="{{site.baseurl}}/assets/images/traceback/1-2.png" /><br /><br />a quick google takes us to <a href="https://github.com/TheBinitGhimire/Web-Shells">this</a> page. it is a list of some webshells. <br />smevk.php is the one being used<br /><img src="{{site.baseurl}}/assets/images/traceback/1-3.png" alt="{{site.baseurl}}/assets/images/traceback/1-3.png" /><br />with the credentials on the source in the github page, we login and upload a php reverse shell to get initial foothold<br /><img src="{{site.baseurl}}/assets/images/traceback/1-4.png" alt="{{site.baseurl}}/assets/images/traceback/1-4.png" /><br /><br />we get a shell as webadmin<br /><img src="{{site.baseurl}}/assets/images/traceback/1-5.png" alt="{{site.baseurl}}/assets/images/traceback/1-5.png" /><br /><br />looks like we have a chance to get shell as user 'sysadmin'  <br /><img src="{{site.baseurl}}/assets/images/traceback/1-6.png" alt="{{site.baseurl}}/assets/images/traceback/1-6.png" /><br /><br />create a lua script to execute os command:<br /><div class="codebox"><div class="codebox">os.execute("/bin/bash")</div></div><br /><br />and execute it with<br /><div class="codebox"><div class="codebox">sudo&nbsp;-u&nbsp;sysadmin&nbsp;/home/sysadmin/luvit&nbsp;exploit.lua</div></div><br /><br />to get a shell as sysadmin. user owned<br /><img src="{{site.baseurl}}/assets/images/traceback/1-7.png" alt="{{site.baseurl}}/assets/images/traceback/1-7.png" /><br /><br />run <a href="https://github.com/DominicBreuker/pspy/blob/master/README.md">pspy32</a> on the box. this is used to monitor processes being executed on the machine<br />we notice <a href="http://manpages.ubuntu.com/manpages/trusty/man5/update-motd.5.html">update-motd.d</a> being run everytime someone logs in. <br /><img src="{{site.baseurl}}/assets/images/traceback/1-8.png" alt="{{site.baseurl}}/assets/images/traceback/1-8.png" /><br /><br />what happens is everytime there is a login, scripts under /etc/update-motd.d/ are executed with root privileges. pretty cool<br />so we can either edit a script aldredy present under /etc/update-motd.d/ or create a new script to read the root flag or spawn root shell, whatever appeals to you<br /><img src="{{site.baseurl}}/assets/images/traceback/1-9.png" alt="{{site.baseurl}}/assets/images/traceback/1-9.png" /><br /><br />do that, login again to execute the script and we own root<br /><img src="{{site.baseurl}}/assets/images/traceback/1-10.png" alt="{{site.baseurl}}/assets/images/traceback/1-10.png" /><br /></body></html>